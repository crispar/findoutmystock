# 아키텍처 다이어그램

이 문서는 Naver 금융 주식 분석 시스템의 아키텍처를 텍스트 기반 다이어그램으로 표현합니다. 데이터의 흐름과 각 컴포넌트의 상호작용을 시각적으로 설명합니다.

## 데이터 흐름도 (Data Flow Diagram)

```
+--------------------------+
|      외부 데이터 소스      |
|    (Naver 금융 웹사이트)   |
+--------------------------+
           |
           | 1. HTTP 요청 (URL)
           v
+--------------------------+
|      데이터 수집 모듈      |
| (urllib, BeautifulSoup)  |
+--------------------------+
           |
           | 2. HTML 페이지 파싱
           v
+------------------------------------------------------------------+
|                            데이터 처리 및 분석 스크립트                |
|               (examples-rename.ipynb / -kosdaq.ipynb)            |
|                                                                  |
|   +-----------------------+      +--------------------------+    |
|   |   시가총액 상위 종목   |----->|      개별 종목 정보      |    |
|   | (top_rank_stocks)     |      |      (stock_info)        |    |
|   +-----------------------+      +--------------------------+    |
|              |                                                   |
|              | 3. 종목 코드 리스트                               |
|              v                                                   |
|   +-----------------------+                                      |
|   |    과거 시세 데이터     |                                      |
|   | (historical_index...) |                                      |
|   +-----------------------+                                      |
|              |                                                   |
|              | 4. 수집된 Raw 데이터                              |
|              v                                                   |
|   +-----------------------+      +--------------------------+    |
|   |    데이터 정제 및 통합   |----->|      핵심 지표 계산      |    |
|   |       (Pandas)        |      | (52주 최저가, 갭 비율 등) |    |
|   +-----------------------+      +--------------------------+    |
|                                                                  |
+------------------------------------------------------------------+
           |
           | 5. 최종 분석 데이터 (DataFrame)
           v
+--------------------------+
|        결과 리포트         |
|   (정렬된 테이블 형식 출력)  |
+--------------------------+

```

## 아키텍처 설명

1.  **외부 데이터 소스**:
    - 시스템은 공개적으로 접근 가능한 **Naver 금융** 웹사이트를 데이터 소스로 사용합니다.
    - 대상 페이지는 시가총액 순위, 기업 정보, 일별 시세 페이지입니다.

2.  **데이터 수집 모듈**:
    - Python의 `urllib.request` 라이브러리를 사용하여 Naver 금융 서버에 HTTP 요청을 보냅니다.
    - 서버로부터 받은 HTML 응답을 `BeautifulSoup` 라이브러리를 이용해 파싱하여 필요한 데이터(종목명, 주식 코드, 주가, 재무 정보 등)를 추출합니다.

3.  **데이터 처리 및 분석 스크립트**:
    - **종목 선정**: `top_rank_stocks` 함수가 시가총액 페이지를 스크래핑하여 분석 대상이 될 상위 N개 종목을 선정합니다.
    - **상세 정보 수집**: `stock_info` 함수가 각 종목의 상세 정보 페이지에 접근해 추가 데이터를 수집합니다.
    - **과거 데이터 수집**: `historical_index_naver_domestic` 함수가 각 종목의 일별 시세 페이지를 순회하며 1년간의 주가 데이터를 가져옵니다.
    - **데이터 정제 및 분석**: 수집된 모든 데이터는 `pandas` DataFrame으로 통합됩니다. 결측치가 처리되고, 이를 바탕으로 52주 최저가, 현재가와의 갭, 갭 비율 등 핵심 투자 지표가 계산됩니다.

4.  **결과 리포트**:
    - 모든 계산이 완료된 후, 최종 데이터는 하나의 DataFrame으로 정리됩니다.
    - 이 DataFrame은 'Gap_Percentage'(갭 비율)를 기준으로 정렬되어, 52주 최저가에 가장 가까운 종목부터 순서대로 사용자에게 보여줍니다. Jupyter Notebook 환경에서는 `display()` 함수를 통해 깔끔한 테이블 형식으로 출력됩니다.

이 아키텍처는 외부 웹사이트에 강하게 의존하며, 웹 페이지의 구조가 변경될 경우 데이터 수집 모듈의 수정이 필요할 수 있습니다. 스크립트의 핵심 로직은 데이터 수집, 처리, 분석, 그리고 리포팅의 네 단계로 명확하게 구분됩니다.